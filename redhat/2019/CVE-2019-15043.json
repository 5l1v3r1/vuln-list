{
  "acknowledgement": "\nRed Hat would like to thank the Grafana team for reporting this issue.\n    ",
  "bugzilla": {
    "description": "\nCVE-2019-15043 grafana: incorrect access control in snapshot HTTP API leads to denial of service\n    ",
    "id": "1746945",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1746945"
  },
  "cvss3": {
    "cvss3_base_score": "4.3",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L",
    "status": "draft"
  },
  "cwe": "(CWE-284|CWE-200)",
  "details": [
    "\nIn Grafana 2.x through 6.x before 6.3.4, parts of the HTTP API allow unauthenticated use. This makes it possible to run a denial of service attack against the server running Grafana.\n    "
  ],
  "mitigation": "\nBlock access to the snapshot feature by blocking the /api/snapshots \nURL via a web application firewall, load balancer, reverse proxy etc.\n\nYou can also set 'external_enabled' to false to disable external \nsnapshot publish endpoint (default true). Note, it will completely\ndisable this feature.\n\n# cat /etc/grafana/grafana.ini\n[...]\n[snapshots]\n# snapshot sharing options\nexternal_enabled = false\nexternal_snapshot_url = https://snapshots-origin.raintank.io\nexternal_snapshot_name = Publish to snapshot.raintank.io\n[...]\n    ",
  "name": "CVE-2019-15043",
  "package_state": [
    {
      "cpe": "cpe:/a:redhat:ceph_storage:2",
      "fix_state": "Out of support scope",
      "package_name": "grafana",
      "product_name": "Red Hat Ceph Storage 2"
    },
    {
      "cpe": "cpe:/a:redhat:ceph_storage:3",
      "fix_state": "Affected",
      "package_name": "grafana",
      "product_name": "Red Hat Ceph Storage 3"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:3.11",
      "fix_state": "Affected",
      "package_name": "grafana-container",
      "product_name": "Red Hat OpenShift Container Platform 3.11"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:4.1",
      "fix_state": "Affected",
      "package_name": "grafana-container",
      "product_name": "Red Hat OpenShift Container Platform 4.1"
    },
    {
      "cpe": "cpe:/a:redhat:storage:3",
      "fix_state": "Affected",
      "package_name": "grafana",
      "product_name": "Red Hat Gluster Storage 3"
    }
  ],
  "public_date": "2019-08-29T18:00:00",
  "references": [
    "\nhttps://grafana.com/blog/2019/08/29/grafana-5.4.5-and-6.3.4-released-with-important-security-fix/\n    "
  ],
  "statement": "\nOpenShift Container Platform secures all usages of Grafana behind the oauth-proxy, preventing access to Grafana without authentication. Red Hat Product Security have rated this vulnerability as Low for OpenShift Container Platform.\n\nRed Hat Ceph Storage 2: \nThis vulnerability has been rated as having a security impact of Moderate. After evaluation and in accordance with the criteria noted in the product support life cycle, there are no plans to address this issue in an upcoming release. Please contact Red Hat Support for further information.\n\nRed Hat Ceph Storage 3: \nThis vulnerability is currently targeted to be addressed in an upcoming release.\n\nRed Hat Gluster Storage 3: \nThis vulnerability is currently targeted to be addressed in an upcoming release.\n\nRed Hat OpenShift Container Platform 3.11: \nThis vulnerability is currently targeted to be addressed in an upcoming release.\n\nRed Hat OpenShift Container Platform 4.1: \nThis vulnerability is currently targeted to be addressed in an upcoming release.\n    ",
  "threat_severity": "Moderate",
  "upstream_fix": "grafana 5.4.5, grafana 6.3.4"
}