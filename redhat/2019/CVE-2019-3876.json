{
  "mitigation": "\nSince at least v3.4, the OpenShift documentation [1] has specified the format for  corsAllowedOrigins to accurately match intended hostnames.  Since at least v3.7, installs will default to use the correct regular expression formatted variables.  Earlier versions may be configured with plain strings, a configuration which will persist across cluster upgrades, opening them to cross origin vulnerabilities such as this.\n\n\nAt a minimum, you should ensure that the corsAllowedOrigin definition within master-config.yaml contains elements in the form \n\n~~~\ncorsAllowedOrigins:\n- (?i)//my\\.subdomain\\.domain\\.com(:|\\z)\n~~~\n\nand not the form\n\n~~~\ncorsAllowedOrigins:\n- domain.com\n~~~\n\nas the first will permit cross origin requests only if the host matches exactly, whereas the second will permit from any host that merely contains the string (such as ABCDdomain.com or even domain.comABCD.com).\n\n\n\nFootnotes:\n\n[1] https://docs.openshift.com/container-platform/3.4/architecture/infrastructure_components/web_console.html#corsAllowedOrigins\n    ",
  "affected_release": [
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "release_date": "2019-07-24T00:00:00Z",
      "advisory": "RHSA-2019:1851",
      "package": "atomic-openshift-3.11.129-1.git.0.bd4f2d5.el7",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat OpenShift Container Platform 3.10",
      "fix_state": "Fix deferred",
      "package_name": "atomic-openshift",
      "cpe": "cpe:/a:redhat:openshift:3.10"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.4",
      "fix_state": "Out of support scope",
      "package_name": "atomic-openshift",
      "cpe": "cpe:/a:redhat:openshift:3.4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.5",
      "fix_state": "Out of support scope",
      "package_name": "atomic-openshift",
      "cpe": "cpe:/a:redhat:openshift:3.5"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.6",
      "fix_state": "Out of support scope",
      "package_name": "atomic-openshift",
      "cpe": "cpe:/a:redhat:openshift:3.6"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.7",
      "fix_state": "Out of support scope",
      "package_name": "atomic-openshift",
      "cpe": "cpe:/a:redhat:openshift:3.7"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.9",
      "fix_state": "Fix deferred",
      "package_name": "atomic-openshift",
      "cpe": "cpe:/a:redhat:openshift:3.9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.1",
      "fix_state": "Not affected",
      "package_name": "openshift",
      "cpe": "cpe:/a:redhat:openshift:4.1"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2019-03-27T00:24:00Z",
  "bugzilla": {
    "description": "\nCVE-2019-3876 web-console: XSS in OAuth server /oauth/token/request endpoint\n    ",
    "id": "1691107",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1691107"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.0",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-79",
  "statement": "\n\n    ",
  "acknowledgement": "\nThis issue was discovered by Mo Khan (Red Hat).\n    ",
  "name": "CVE-2019-3876",
  "document_distribution": "",
  "details": [
    "\nA flaw was found in the /oauth/token/request custom endpoint of the OpenShift OAuth server allowing for XSS generation of CLI tokens due to missing X-Frame-Options and CSRF protections. If not otherwise prevented, a separate XSS vulnerability via JavaScript could further allow for the extraction of these tokens.\n    ",
    "\nA flaw was found in the /oauth/token/request custom endpoint of the OpenShift OAuth server allowing for XSS generation of CLI tokens due to missing X-Frame-Options and CSRF protections. If not otherwise prevented, a separate XSS vulnerability via JavaScript could further allow for the extraction of these tokens.\n    "
  ],
  "references": null
}