{
  "mitigation": "Currently, there is no mitigation for this issue except by removing manually the temporary created file after every run.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Ansible Engine 2",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ansible_engine:2"
    },
    {
      "product_name": "Red Hat Ansible Tower 3",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ansible_tower:3"
    },
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Out of support scope",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10 (Newton)",
      "fix_state": "Out of support scope",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:openstack:10"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Will not fix",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2020-03-18T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2020-10685 Ansible: modules which use files encrypted with vault are not properly cleaned up",
    "id": "1814627",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1814627"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-377",
  "statement": "* Ansible Engine 2.7.16, 2.8.10, and 2.9.6 as well as previous versions are affected.\n* Ansible Tower 3.4.5, 3.5.5 and 3.6.3 as well as previous versions are affected.",
  "acknowledgement": "Red Hat would like to thank Damien Aumaitre (Quarkslab) and Nicolas Surbayrole (Quarkslab) for reporting this issue.",
  "name": "CVE-2020-10685",
  "document_distribution": "",
  "details": [
    "A flaw was found on Ansible Engine when using modules which decrypts vault files such as assemble, script, unarchive, win_copy, aws_s3 or copy modules.  The temporary directory is created in /tmp leaves the secrets unencrypted.\nOn Operating Systems which /tmp is not a tmpfs but part of the root partition, the directory is only cleared on boot and the decrypted data remains when the host is switched off. The system will be vulnerable when the system is not running. So decrypted data must be cleared as soon as possible and the data which normally is encrypted is sensible."
  ],
  "references": null
}