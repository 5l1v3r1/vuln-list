{
  "mitigation": "The issue can be mitigated as follows:\nFor JWS(Tomcat),\nIf your site is not actively using the AJP Connector, simply comment it out from the \u003cTOMCAT_HOME\u003e/conf/server.xml file as \n~~~\n\u003c!-- \u003cConnector port = \"8009\" protocol = \"AJP / 1.3\" redirectPort = \"8443\" /\u003e --\u003e\n~~~\nIf AJP connector is required and cannot be commented/deactivated, then we recommend to set a secret password for the AJP conduit - Only requests from workers with the same secret keyword will be accepted. At the Tomcat side, edit conf/server.xml:\n~~~\n\u003cConnector port = \"8009\"\nprotocol = \"AJP / 1.3\"\nredirectPort = \"8443\"\naddress = \"YOUR_TOMCAT_IP_ADDRESS\" \nrequiredSecret = \"YOUR_AJP_SECRET\" /\u003e\n~~~\nFor JBoss EAP 6.4 (JBossWeb 7.x),\nThe AJP connector is enabled by default only in standalone-full-ha.xml, standalone-ha.xml and ha and full-ha profiles in domain.xml. AJP connector can be secured as follows:\nIf you do not use AJP, you can disable the AJP port configuration in your standalone-*.xml and/or domain.xml file by setting enabled=\"false\" as shown below or comment out the whole \u003cconnector name=\"AJP\" .../\u003e clause:\n~~~\n\u003cconnector name=\"AJP\" protocol=\"AJP/1.3\" scheme=\"http\" socket-binding=\"ajp\" enabled=\"false\"/\u003e\n~~~\nIf AJP connector is a requirement and cannot be commented or deactivated, then, it is recommended to add credential to AJP connector by configuring the following system property.\n~~~\n\u003csystem-properties\u003e\n\u003cproperty name=\"org.apache.coyote.ajp.DEFAULT_REQUIRED_SECRET\" value=\"YOUR_AJP_SECRET\"/\u003e\n\u003c/system-properties\u003e\n~~~\nNote that YOUR_AJP_SECRET must be changed to a value that is highly secure and cannot be easily guessed.\nFor Apache httpd (httpd in JBCS or RHEL),\nWhen the above setting is configured, the same secret value on the front-end proxy (mod_proxy or mod_jk) will be required to be configured.\n* mod_proxy (mod_proxy_ajp / mod_proxy_balancer using ajp)\nThe secret property support was added since JBCS httpd 2.4.37 or since RHEL 7 httpd-2.4.6-67.el7.x86_641.[1]\nFor mod_proxy_ajp, the secret property can be added to ProxyPass setting.\nFor mod_proxy_balancer, the secret property can be added to each BalancerMember setting.\nFor example, add secret=YOUR_AJP_SECRET in your configuration (e.g. \u003cHTTPD_HOME\u003e/conf/httpd.conf or \u003cHTTPD_HOME\u003e/conf.d/proxy_ajp.conf) like the following:\n- mod_proxy_ajp:\n~~~\nProxyPass /example/ ajp://localhost:8009/example/ secret=YOUR_AJP_SECRET\n~~~\n- mod_proxy_balancer:\n~~~\n\u003cProxy balancer://mycluster\u003e\nBalancerMember ajp://node1:8009 route=node1 secret=YOUR_AJP_SECRET\nBalancerMember ajp://node2:8009 route=node2 secret=YOUR_AJP_SECRET\n\u003c/Proxy\u003e\nProxyPass /example/ balancer://mycluster/example/ stickysession=JSESSIONID|jsessionid\n~~~\n* mod_jk\nmod_jk - secret can be specified to a worker or a load balancer in workers.properties. If you set a secret on a load balancer, all its members will inherit this secret. This secret property support was added in mod_jk 1.2.12 onwards.\nFor example, add the following in your workers.properties:\n~~~\nworker.\u003cWORKER_NAME\u003e.secret=YOUR_AJP_SECRET\n~~~\nEnsure that WORKER_NAME must be replaced with the appropriate name.\n* mod_cluster\nmod_cluster does not support secret property.[2] When secret is configured on the AJP connector in Tomcat/JBoss side, you can not connect AJP without a correct secret value. So, you need to use http or https for mod_cluster.\n[1] https://bugzilla.redhat.com/show_bug.cgi?id=1397241\n[2] https://docs.modcluster.io/#migration-from-modjk",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat JBoss Data Virtualization 6",
      "fix_state": "Affected",
      "package_name": "jbossweb",
      "cpe": "cpe:/a:redhat:jboss_data_virtualization:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Affected",
      "package_name": "jbossweb",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Not affected",
      "package_name": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    },
    {
      "product_name": "Red Hat Descision Manager 7",
      "fix_state": "Not affected",
      "package_name": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3",
      "fix_state": "Affected",
      "package_name": "ajp",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5",
      "fix_state": "Affected",
      "package_name": "ajp",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Affected",
      "package_name": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Affected",
      "package_name": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat OpenShift Application Runtimes",
      "fix_state": "Affected",
      "package_name": "tomcat",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10 (Newton)",
      "fix_state": "Will not fix",
      "package_name": "opendaylight",
      "cpe": "cpe:/a:redhat:openstack:10"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Will not fix",
      "package_name": "opendaylight",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Affected",
      "package_name": "rh-java-common-tomcat",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Out of support scope",
      "package_name": "tomcat5",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Affected",
      "package_name": "tomcat6",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Affected",
      "package_name": "tomcat",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "pki-deps:10.6/pki-servlet-container",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "pki-deps:10.6/pki-servlet-engine",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2020-02-20T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2020-1938 tomcat: Apache Tomcat AJP File Read/Inclusion Vulnerability",
    "id": "1806398",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1806398"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.6",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-285",
  "statement": "Please refer to the Red Hat knowledgebase article: https://access.redhat.com/solutions/4851251",
  "acknowledgement": "",
  "name": "CVE-2020-1938",
  "document_distribution": "",
  "details": [
    "When using the Apache JServ Protocol (AJP), care must be taken when trusting incoming connections to Apache Tomcat. Tomcat treats AJP connections as having higher trust than, for example, a similar HTTP connection. If such connections are available to an attacker, they can be exploited in ways that may be surprising. In Apache Tomcat 9.0.0.M1 to 9.0.0.30, 8.5.0 to 8.5.50 and 7.0.0 to 7.0.99, Tomcat shipped with an AJP Connector enabled by default that listened on all configured IP addresses. It was expected (and recommended in the security guide) that this Connector would be disabled if not required. This vulnerability report identified a mechanism that allowed: - returning arbitrary files from anywhere in the web application - processing any file in the web application as a JSP Further, if the web application allowed file upload and stored those files within the web application (or the attacker was able to control the content of the web application by some other means) then this, along with the ability to process a file as a JSP, made remote code execution possible. It is important to note that mitigation is only required if an AJP port is accessible to untrusted users. Users wishing to take a defence-in-depth approach and block the vector that permits returning arbitrary files and execution as JSP may upgrade to Apache Tomcat 9.0.31, 8.5.51 or 7.0.100 or later. A number of changes were made to the default AJP Connector configuration in 9.0.31 to harden the default configuration. It is likely that users upgrading to 9.0.31, 8.5.51 or 7.0.100 or later will need to make small changes to their configurations.",
    "CVE-2020-1938 is a file read/inclusion vulnerability in the AJP connector in Apache Tomcat. This is enabled by default with a default configuration port of 8009. A remote, unauthenticated attacker could exploit this vulnerability to read web application files from a vulnerable server. In instances where the vulnerable server allows file uploads, an attacker could upload malicious JavaServer Pages (JSP) code within a variety of file types and trigger this vulnerability to gain remote code execution (RCE).\nIt affects the version of Apache Tomcat 9 before 9.0.31, Tomcat 8 before 8.5.51, and Tomcat 7 before 7.0.100."
  ],
  "references": [
    "https://www.cnvd.org.cn/webinfo/show/5415\nhttps://www.tenable.com/blog/cve-2020-1938-ghostcat-apache-tomcat-ajp-file-readinclusion-vulnerability-cnvd-2020-10487\nhttps://meterpreter.org/cve-2020-1938-apache-tomcat-ajp-connector-remote-code-execution-vulnerability-alert/\nhttps://tomcat.apache.org/security-7.html#Fixed_in_Apache_Tomcat_7.0.100\nhttps://tomcat.apache.org/security-8.html#Fixed_in_Apache_Tomcat_8.5.51\nhttps://tomcat.apache.org/security-9.html#Fixed_in_Apache_Tomcat_9.0.31"
  ]
}