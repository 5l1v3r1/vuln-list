{
  "mitigation": "The ajp-listener in EAP 7/Undertow  does not offer \"secret\" (authentication credential) parameter on, however configuration can be secured with the following expression-filter inside undertow subsystem:\n~~~\n\u003csubsystem xmlns=\"urn:jboss:domain:undertow:7.0\" ...\u003e\n...\n\u003cserver name=\"default-server\"\u003e\n\u003chttp-listener name=\"default\" socket-binding=\"http\" redirect-socket=\"https\" enable-http2=\"true\"/\u003e\n\u003cajp-listener name=\"ajp\" socket-binding=\"ajp\"/\u003e\n\u003chttps-listener name=\"https\" socket-binding=\"https\" security-realm=\"ApplicationRealm\" enable-http2=\"true\"/\u003e\n\u003chost name=\"default-host\" alias=\"localhost\"\u003e\n...\n\u003c!-- add the following with your AJP port (8009) --\u003e\n\u003cfilter-ref name=\"secret-checker\" predicate=\"equals(%p, 8009)\"/\u003e\n\u003c/host\u003e\n\u003c/server\u003e\n...\n\u003cfilters\u003e\n\u003c!-- add the following with your credential (YOUR_AJP_SECRET) --\u003e\n\u003cexpression-filter name=\"secret-checker\" expression=\"not equals(%{r,secret}, 'YOUR_AJP_SECRET') -\u003e response-code(403)\"/\u003e\n\u003c/filters\u003e\n\u003c/subsystem\u003e\n~~~\nNote that YOUR_AJP_SECRET must be changed to a value that is highly secure and cannot be easily guessed.\nIf the above secured configuration is not possible then consider binding Undertowâ€™s AJP port to the loopback interface, or having a firewall which only allows access from trusted hosts would considerably reduce the attack surface to local, or trusted users.\nFor Apache httpd (httpd in JBCS or RHEL),\nWhen the above setting is configured, the same secret value on the front-end proxy (mod_proxy or mod_jk) will be required to be configured.\n* mod_proxy (mod_proxy_ajp / mod_proxy_balancer using ajp)\nThe secret property support was added since JBCS httpd 2.4.37 or since RHEL 7 httpd-2.4.6-67.el7.x86_641.[1]\nFor mod_proxy_ajp, the secret property can be added to ProxyPass setting.\nFor mod_proxy_balancer, the secret property can be added to each BalancerMember setting.\nFor example, add secret=YOUR_AJP_SECRET in your configuration (e.g. \u003cHTTPD_HOME\u003e/conf/httpd.conf or \u003cHTTPD_HOME\u003e/conf.d/proxy_ajp.conf) like the following:\n- mod_proxy_ajp:\n~~~\nProxyPass /example/ ajp://localhost:8009/example/ secret=YOUR_AJP_SECRET\n~~~\n- mod_proxy_balancer:\n~~~\n\u003cProxy balancer://mycluster\u003e\nBalancerMember ajp://node1:8009 route=node1 secret=YOUR_AJP_SECRET\nBalancerMember ajp://node2:8009 route=node2 secret=YOUR_AJP_SECRET\n\u003c/Proxy\u003e\nProxyPass /example/ balancer://mycluster/example/ stickysession=JSESSIONID|jsessionid\n~~~\n* mod_jk\nmod_jk - secret can be specified to a worker or a load balancer in workers.properties. If you set a secret on a load balancer, all its members will inherit this secret. This secret property support was added in mod_jk 1.2.12 onwards.\nFor example, add the following in your workers.properties:\n~~~\nworker.\u003cWORKER_NAME\u003e.secret=YOUR_AJP_SECRET\n~~~\nEnsure that WORKER_NAME must be replaced with the appropriate name.\n* mod_cluster\nmod_cluster does not support secret property.[2] When secret is configured on the AJP connector in Tomcat/JBoss side, you can not connect AJP without a correct secret value. So, you need to use http or https for mod_cluster.\n[1] https://bugzilla.redhat.com/show_bug.cgi?id=1397241\n[2] https://docs.modcluster.io/#migration-from-modjk",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Affected",
      "package_name": "undertow",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Continuous Delivery",
      "fix_state": "Affected",
      "package_name": "undertow",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "fix_state": "Affected",
      "package_name": "undertow",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Not affected",
      "package_name": "undertow",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    },
    {
      "product_name": "Red Hat Descision Manager 7",
      "fix_state": "Not affected",
      "package_name": "undertow",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Under investigation",
      "package_name": "undertow",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Under investigation",
      "package_name": "undertow",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat OpenShift Application Runtimes",
      "fix_state": "Affected",
      "package_name": "undertow",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Will not fix",
      "package_name": "opendaylight",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat Single Sign-On 7",
      "fix_state": "Affected",
      "package_name": "undertow",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2020-02-26T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2020-1745 undertow: AJP File Read/Inclusion Vulnerability",
    "id": "1807305",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1807305"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.6",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-285",
  "statement": "Please refer to the Red Hat knowledgebase article: https://access.redhat.com/solutions/4851251 and CVE page https://access.redhat.com/security/cve/CVE-2020-1938.",
  "acknowledgement": "",
  "name": "CVE-2020-1745",
  "document_distribution": "",
  "details": [
    "No description is available for this CVE."
  ],
  "references": [
    "https://www.cnvd.org.cn/webinfo/show/5415\nhttps://www.tenable.com/blog/cve-2020-1938-ghostcat-apache-tomcat-ajp-file-readinclusion-vulnerability-cnvd-2020-10487\nhttps://meterpreter.org/cve-2020-1938-apache-tomcat-ajp-connector-remote-code-execution-vulnerability-alert/"
  ]
}