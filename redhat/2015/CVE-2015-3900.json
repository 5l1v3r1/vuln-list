{
  "affected_release": [
    {
      "advisory": "RHSA-2015:1657",
      "cpe": "cpe:/a:redhat:rhel_software_collections:2::el6",
      "package": "rh-ruby22-ruby-2.2.2-12.el6",
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
      "release_date": "2015-08-24T00:00:00"
    },
    {
      "advisory": "RHSA-2015:1657",
      "cpe": "cpe:/a:redhat:rhel_software_collections:2::el7",
      "package": "rh-ruby22-ruby-2.2.2-12.el7",
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2015-08-24T00:00:00"
    }
  ],
  "bugzilla": {
    "description": "\nCVE-2015-3900 rubygems: DNS hijacking vulnerability in api_endpoint()\n    ",
    "id": "1236116",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1236116"
  },
  "cvss": {
    "cvss_base_score": "7.9",
    "cvss_scoring_vector": "AV:A/AC:M/Au:N/C:C/I:C/A:C",
    "status": "verified"
  },
  "cwe": "CWE-20-\u003eCWE-345",
  "details": [
    "\nRubyGems 2.0.x before 2.0.16, 2.2.x before 2.2.4, and 2.4.x before 2.4.7 does not validate the hostname when fetching gems or making API requests, which allows remote attackers to redirect requests to arbitrary domains via a crafted DNS SRV record, aka a \"DNS hijack attack.\"\n    ",
    "\nA flaw was found in a way rubygems verified the API endpoint hostname retrieved through a DNS SRV record. A man-in-the-middle attacker could use this flaw to force a client to download content from an untrusted domain.\n    "
  ],
  "name": "CVE-2015-3900",
  "package_state": [
    {
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5",
      "fix_state": "Not affected",
      "package_name": "rubygems",
      "product_name": "CloudForms Management Engine 5"
    },
    {
      "cpe": "cpe:/a:redhat:enterprise_mrg:2",
      "fix_state": "Not affected",
      "package_name": "rubygems",
      "product_name": "Red Hat Enterprise MRG 2"
    },
    {
      "cpe": "cpe:/a:redhat:network_satellite:6",
      "fix_state": "Not affected",
      "package_name": "rubygems",
      "product_name": "Red Hat Satellite 6"
    },
    {
      "cpe": "cpe:/a:redhat:openshift:2",
      "fix_state": "Not affected",
      "package_name": "rubygems",
      "product_name": "Red Hat OpenShift Enterprise 2"
    },
    {
      "cpe": "cpe:/a:redhat:openstack:5",
      "fix_state": "Not affected",
      "package_name": "rubygems",
      "product_name": "Red Hat Enterprise Linux OpenStack Platform 5.0 (Icehouse)"
    },
    {
      "cpe": "cpe:/a:redhat:rhel_sam:1",
      "fix_state": "Not affected",
      "package_name": "ruby193-ruby",
      "product_name": "Red Hat Subscription Asset Manager 1"
    },
    {
      "cpe": "cpe:/a:redhat:rhel_software_collections:2",
      "fix_state": "Not affected",
      "package_name": "ruby193-ruby",
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux"
    },
    {
      "cpe": "cpe:/a:redhat:rhel_software_collections:2",
      "fix_state": "Will not fix",
      "package_name": "ruby200-ruby",
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:5",
      "fix_state": "Not affected",
      "package_name": "ruby",
      "product_name": "Red Hat Enterprise Linux 5"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:6",
      "fix_state": "Not affected",
      "package_name": "ruby",
      "product_name": "Red Hat Enterprise Linux 6"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:6",
      "fix_state": "Not affected",
      "package_name": "rubygems",
      "product_name": "Red Hat Enterprise Linux 6"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:7",
      "fix_state": "Will not fix",
      "package_name": "ruby",
      "product_name": "Red Hat Enterprise Linux 7"
    }
  ],
  "public_date": "2015-05-14T00:00:00",
  "references": [
    "\nhttp://blog.rubygems.org/2015/05/14/CVE-2015-3900.html\n    "
  ],
  "statement": "\nThis issue did not affect the versions of rubygems as shipped with Red Hat Enterprise Linux 6, Red Hat Enterprise MRG 2.5, Red Hat Satellite 6, Red Hat Openstack 5, Red Hat Openshift Enterprise 2 as they did not include support for getting API endpoint using SRV DNS records.\n\nThis issue did not affect the versions of ruby as shipped with Red Hat Enterprise Linux 5 and 6 as they did not include support for getting API endpoint using SRV DNS records. The issue did not affect version of ruby as shipped with Red Hat Enterprise Linux 7, as the support for getting API endpoint using SRV DNS records is included, but inactive.\n\nThis issue did not affect the versions of ruby193-ruby as shipped with Red Hat Subscription Asset Manager and Red Hat Software Collections as they did not include support for getting API endpoint using SRV DNS records.\n\nThe issue did not affect version of ruby200-ruby as shipped with Red Hat Software Collections, as the support for getting API endpoint using SRV DNS records is included, but inactive.\n    ",
  "threat_severity": "Important",
  "upstream_fix": "rubygems 2.0.16, rubygems 2.2.4, rubygems 2.4.7"
}