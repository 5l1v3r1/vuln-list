{
  "mitigation": "\nDisabling the use of zero page:\n\n\nIt is possible to prevent the zero page from being mapped as a huge page, by modifying a configuration tunable in the /sys directory as shown below.  This prevents the flaw from being exercised in this method.\n\n#  echo 0 \u003e /sys/kernel/mm/transparent_hugepage/use_zero_page\n\n\nDisabling huge pages:\n\nIt is possible to mitigate this flaw by disabling hugepages on a system.  Some user applications may require hugepages to be performant, and may suffer a performance penalty when running without hugepages.\n\nRed Hat has existing solutions created instructing how to disable transparent\n\nHow to disable transparent hugepages (THP) on Red Hat Enterprise Linux 7\nhttps://access.redhat.com/solutions/1320153\n\nIf your application may require transparent huge pages, please consult your software vendor to confirm.\n    ",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2018-01-25T00:00:00Z",
      "advisory": "RHSA-2018:0180",
      "package": "",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise MRG 2",
      "fix_state": "Not affected",
      "package_name": "realtime-kernel",
      "cpe": "cpe:/a:redhat:enterprise_mrg:2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2017-11-30T00:00:00Z",
  "bugzilla": {
    "description": "\nCVE-2017-1000405 kernel: pmd can become dirty without going through a COW cycle\n    ",
    "id": "1516514",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1516514"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.1",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-362",
  "statement": "\n\n    ",
  "acknowledgement": "\nRed Hat would like to thank Eylon Ben Yaakov and Daniel Shapiro for reporting this issue.\n    ",
  "name": "CVE-2017-1000405",
  "document_distribution": "",
  "details": [
    "\nThe Linux Kernel versions 2.6.38 through 4.14 have a problematic use of pmd_mkdirty() in the touch_pmd() function inside the THP implementation. touch_pmd() can be reached by get_user_pages(). In such case, the pmd will become dirty. This scenario breaks the new can_follow_write_pmd()'s logic - pmd can become dirty without going through a COW cycle. This bug is not as severe as the original \"Dirty cow\" because an ext4 file (or any other regular file) cannot be mapped using THP. Nevertheless, it does allow us to overwrite read-only huge pages. For example, the zero huge page and sealed shmem files can be overwritten (since their mapping can be populated using THP). Note that after the first write page-fault to the zero page, it will be replaced with a new fresh (and zeroed) thp.\n    ",
    "\nA flaw was found in the patches used to fix the 'dirtycow' vulnerability (CVE-2016-5195). An attacker, able to run local code, can exploit a race condition in transparent huge pages to modify usually read-only huge pages.\n    "
  ],
  "references": null
}