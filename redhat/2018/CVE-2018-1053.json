{
  "affected_release": [
    {
      "product_name": "CloudForms Management Engine 5.9",
      "release_date": "2018-12-13T00:00:00Z",
      "advisory": "RHSA-2018:3816",
      "package": "postgresql96-9.6.10-1PGDG.el7at",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-9.5.14-1.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-9.6.10-1.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6.7 EUS",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-9.5.14-1.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 6.7 EUS",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-9.6.10-1.el6",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-9.5.14-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-9.6.10-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.3 EUS",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-9.5.14-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.3 EUS",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-9.6.10-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-9.5.14-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.4 EUS",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-9.6.10-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2018-08-20T00:00:00Z",
      "advisory": "RHSA-2018:2511",
      "package": "rh-postgresql95-postgresql-9.5.14-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections for Red Hat Enterprise Linux 7.5 EUS",
      "release_date": "2018-08-27T00:00:00Z",
      "advisory": "RHSA-2018:2566",
      "package": "rh-postgresql96-postgresql-9.6.10-1.el7",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "package_state": [
    {
      "product_name": "CloudForms Management Engine 5",
      "fix_state": "Will not fix",
      "package_name": "postgresql94",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "CloudForms Management Engine 5",
      "fix_state": "Not affected",
      "package_name": "rh-postgresql95-postgresql",
      "cpe": "cpe:/a:redhat:cloudforms_managementengine:5"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat JBoss Operations Network 3",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/a:redhat:jboss_operations_network:3"
    },
    {
      "product_name": "Red Hat Mobile Application Platform 4",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/a:redhat:mobile_application_platform:4"
    },
    {
      "product_name": "Red Hat Satellite 5",
      "fix_state": "Will not fix",
      "package_name": "postgresql95-postgresql",
      "cpe": "cpe:/a:redhat:network_satellite:5"
    },
    {
      "product_name": "Red Hat Single Sign-On 7",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Will not fix",
      "package_name": "rh-postgresql94-postgresql",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Not affected",
      "package_name": "rh-postgresql10-postgresql",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "postgresql84",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 5",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:5"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2018-02-08T00:00:00Z",
  "bugzilla": {
    "description": "\nCVE-2018-1053 postgresql: pg_upgrade creates file of sensitive metadata under prevailing umask\n    ",
    "id": "1539619",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1539619"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.7",
    "cvss3_scoring_vector": "CVSS:3.0/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-377",
  "statement": "\n\n    ",
  "acknowledgement": "\nRed Hat would like to thank the PostgreSQL project for reporting this issue. Upstream acknowledges Tom Lane as the original reporter.\n    ",
  "name": "CVE-2018-1053",
  "document_distribution": "",
  "details": [
    "\nIn postgresql 9.3.x before 9.3.21, 9.4.x before 9.4.16, 9.5.x before 9.5.11, 9.6.x before 9.6.7 and 10.x before 10.2, pg_upgrade creates file in current working directory containing the output of `pg_dumpall -g` under umask which was in effect when the user invoked pg_upgrade, and not under 0077 which is normally used for other temporary files. This can allow an authenticated attacker to read or modify the one file, which may contain encrypted or unencrypted database passwords. The attack is infeasible if a directory mode blocks the attacker searching the current working directory or if the prevailing umask blocks the attacker opening the file.\n    ",
    "\nThis release of CloudForms corrects an issue invoked when running pg_upgrade by which attackers could read or modify the output of `pg_dumpall -g` in the current working directory. With this release, any attack is rendered infeasible as the directory mode blocks an intruder from searching the current working directory, and the prevailing umask prevents attackers from opening the file.\n    "
  ],
  "references": [
    "\nhttps://www.postgresql.org/about/news/1829/\n    "
  ]
}