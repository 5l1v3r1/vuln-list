{
  "IssueID": 9249,
  "VulnerabilityID": "CVE-2018-10918",
  "Release": "3.9",
  "Package": "samba",
  "Repository": "main",
  "FixedVersion": "4.8.4-r0",
  "Subject": "[3.9] samba: Multiple vulnerabilities (CVE-2018-10858, CVE-2018-10918, CVE-2018-10919, CVE-2018-1139, CVE-2018-1140)",
  "Description": "h2. CVE-2018-10858: Insufficient input validation on client directory listing in libsmbclient.\r\n\r\nSamba releases 3.2.0 to 4.8.3 (inclusive) contain an error in libsmbclient that could allow a malicious server \r\nto overwrite client heap memory by returning an extra long filename in a directory listing.\r\n\r\nh3. Fixed In Version:\r\n\r\nsamba 4.6.16, samba 4.7.9, samba 4.8.4\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2018-10858.html\r\nhttps://www.samba.org/samba/history/security.html\r\n\r\nh2. CVE-2018-10918: Denial of Service Attack on AD DC DRSUAPI server\r\n\r\nAll versions of Samba from 4.7.0 onwards are vulnerable to a denial of\r\nservice attack which can crash the \"samba\" process when Samba is an\r\nActive Directory Domain Controller.\r\n\r\nh3. Fixed In Version:\r\n\r\nsamba 4.7.9, samba 4.8.4\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2018-10918.html\r\nhttps://www.samba.org/samba/history/security.html\r\n\r\nh2. CVE-2018-10919: Confidential attribute disclosure via substring search\r\n\r\nAll versions of the Samba Active Directory LDAP server from 4.0.0\r\nonwards are vulnerable to the disclosure of confidential attribute\r\nvalues, both of attributes where the schema SEARCH_FLAG_CONFIDENTIAL\r\n(0x80) searchFlags bit and where an explicit Access Control Entry has\r\nbeen specified on the ntSecurityDescriptor.\r\n\r\nh3. Fixed In Version:\r\n\r\nsamba 4.6.16, samba 4.7.9, samba 4.8.4\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2018-10919.html\r\nhttps://www.samba.org/samba/history/security.html\r\n\r\nh2. CVE-2018-1139: Weak authentication protocol regression\r\n\r\nSamba releases 4.7.0 to 4.8.3 (inclusive) contain an error which\r\nallows authentication using NTLMv1 over an SMB1 transport (either\r\ndirectory or via NETLOGON SamLogon calls from a member server), even\r\nwhen NTLMv1 is explicitly disabled on the server.\r\n\r\nNormally, the use of NTLMv1 is disabled by default in favor of NTLMv2.\r\nThis has been the default since Samba 4.5. A code restructuring in the\r\nNTLM authentication implementation of Samba in 4.7.0 caused this\r\nregression to occur.\r\n\r\nh3. Fixed In Version:\r\n\r\nsamba 4.7.9, samba 4.8.4\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2018-1139.html\r\nhttps://www.samba.org/samba/history/security.html\r\n\r\nh2. CVE-2018-1140: Denial of Service Attack on DNS and LDAP server\r\n\r\nAll versions of Samba from 4.8.0 onwards are vulnerable to a denial of\r\nservice attack when Samba is an Active Directory Domain Controller.\r\n\r\nh3. Fixed In Version:\r\n\r\nsamba 4.8.4\r\n\r\nh3. References:\r\n\r\nhttps://bugzilla.redhat.com/show_bug.cgi?id=%20CVE-2018-1140\r\nhttps://www.samba.org/samba/history/security.html\r\n\r\n\r\n\r\n"
}