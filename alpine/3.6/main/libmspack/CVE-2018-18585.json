{
  "IssueID": 9666,
  "VulnerabilityID": "CVE-2018-18585",
  "Release": "3.6",
  "Package": "libmspack",
  "Repository": "main",
  "FixedVersion": "0.8_alpha-r0",
  "Subject": "[3.6] libmspack: Multiple vulnerabilities (CVE-2018-18584, CVE-2018-18585, CVE-2018-18586)",
  "Description": "h2. CVE-2018-18584: A CAB file with a Quantum-compressed block of exactly 38912 bytes will write one byte beyond the end of the input buffer\r\n\r\nIn mspack/cab.h in libmspack before 0.8alpha and cabextract before 1.8, the CAB \r\nblock input buffer is one byte too small for the maximal Quantum block, leading to an out-of-bounds write.\r\n\r\nh3. References:\r\n\r\nhttps://www.cabextract.org.uk/libmspack/\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-18584\r\n\r\nh3. Patch:\r\n\r\nhttps://github.com/kyz/libmspack/commit/40ef1b4093d77ad3a5cfcee1f5cb6108b3a3bcc2\r\n\r\nh2. CVE-2018-18585: CHM files with blank filenames (by having embedded nulls) are allowed, which trips up clients that expect non-blank filenames\r\n\r\nchmd_read_headers in mspack/chmd.c in libmspack before 0.8alpha accepts a filename \r\nthat has '\\0' as its first or second character (such as the \"/\\0\" name).\r\n\r\n\r\n\r\nh3. References:\r\n\r\nhttps://www.cabextract.org.uk/libmspack/\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-18585\r\n\r\nh3. Patch:\r\n\r\nhttps://github.com/kyz/libmspack/commit/8759da8db6ec9e866cb8eb143313f397f925bb4f\r\n\r\n\r\nh2. CVE-2018-18586: chmextract makes no attempt to protect you from relative/absolute paths in CHM filenames\r\n\r\nDISPUTED ** chmextract.c in the chmextract sample program, as distributed with libmspack before 0.8alpha, does not protect against absolute/relative pathnames in CHM files, leading to Directory Traversal. NOTE: the vendor disputes that this is a libmspack vulnerability, because chmextract.c was only intended as a source-code example, not a supported application.\r\n\r\nh3. References:\r\n\r\nhttps://www.cabextract.org.uk/libmspack/\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-18586\r\n\r\nh3. Patch:\r\n\r\nhttps://github.com/kyz/libmspack/commit/7cadd489698be117c47efcadd742651594429e6d\r\n\r\n"
}