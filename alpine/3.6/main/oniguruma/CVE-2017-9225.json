{
  "IssueID": 7812,
  "VulnerabilityID": "CVE-2017-9225",
  "Release": "3.6",
  "Package": "oniguruma",
  "Repository": "main",
  "FixedVersion": "6.3.0-r0",
  "Subject": "[3.6] oniguruma: Multiple vulnerabilities (CVE-2017-9224, CVE-2017-9225, CVE-2017-9226, CVE-2017-9227, CVE-2017-9228)",
  "Description": "*CVE-2017-9224*: An issue was discovered in *Oniguruma 6.2.0*, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. \r\nA stack out-of-bounds read occurs in match_at() during regular expression searching. A logical error involving order of validation and access in \r\nmatch_at() could result in an out-of-bounds read from a stack buffer.\r\n\r\nh3. Fixed In Version:\t\r\n\r\noniguruma 6.3.0\r\n\r\n\r\nh3. References:\r\n\r\nhttps://github.com/kkos/oniguruma/issues/57\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-9224\r\n\r\n\r\n*CVE-2017-9225*: An issue was discovered in *Oniguruma 6.2.0*, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. \r\nA stack out-of-bounds write in onigenc_unicode_get_case_fold_codes_by_str() occurs during regular expression compilation. Code point 0xFFFFFFFF \r\nis not properly handled in unicode_unfold_key(). A malformed regular expression could result in 4 bytes being written off the end of a stack buffer \r\nof expand_case_fold_string() during the call to onigenc_unicode_get_case_fold_codes_by_str(), a typical stack buffer overflow.\r\n\r\nh3. Fixed In Version:\t\r\n\r\noniguruma 6.3.0\r\n\r\n\r\nh3. References:\r\n\r\nhttps://github.com/kkos/oniguruma/issues/56\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-9225\r\n\r\n\r\n\r\n*CVE-2017-9226*: An issue was discovered in *Oniguruma 6.2.0*, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. \r\nA heap out-of-bounds write or read occurs in next_state_val() during regular expression compilation. Octal numbers larger than 0xff are not handled \r\ncorrectly in fetch_token() and fetch_token_in_cc(). A malformed regular expression containing an octal number in the form of '\\700' would produce \r\nan invalid code point value larger than 0xff in next_state_val(), resulting in an out-of-bounds write memory corruption.\r\n\r\nh3. Fixed In Version:\t\r\n\r\noniguruma 6.3.0\r\n\r\n\r\nh3. References:\r\n\r\nhttps://github.com/kkos/oniguruma/issues/55\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-9226\r\n\r\n*CVE-2017-9227*: An issue was discovered in *Oniguruma 6.2.0*, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. \r\nA stack out-of-bounds read occurs in mbc_enc_len() during regular expression searching. Invalid handling of reg-\u003edmin in forward_search_range() \r\ncould result in an invalid pointer dereference, as an out-of-bounds read from a stack buffer.\r\n\r\nh3. Fixed In Version:\t\r\n\r\noniguruma 6.3.0\r\n\r\n\r\nh3. References:\r\n\r\nhttps://github.com/kkos/oniguruma/issues/58\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-9227\r\n\r\n*CVE-2017-9228*: An issue was discovered in *Oniguruma 6.2.0*, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. \r\nA heap out-of-bounds write occurs in bitset_set_range() during regular expression compilation due to an uninitialized variable from an incorrect state transition. \r\nAn incorrect state transition in parse_char_class() could create an execution path that leaves a critical local variable uninitialized until it's used as an index, \r\nresulting in an out-of-bounds write memory corruption.\r\n\r\nh3. Fixed In Version:\t\r\n\r\noniguruma 6.3.0\r\n\r\n\r\nh3. References:\r\n\r\nhttps://github.com/kkos/oniguruma/issues/60\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-9228\r\n\r\n*CVE-2017-9229*: An issue was discovered in *Oniguruma 6.2.0*, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5.\r\nA SIGSEGV occurs in left_adjust_char_head() during regular expression compilation. Invalid handling of reg-\u003edmax in forward_search_range() could result \r\nin an invalid pointer dereference, normally as an immediate denial-of-service condition.\r\n\r\nh3. Fixed In Version:\t\r\n\r\noniguruma 6.3.0\r\n\r\nh3. References:\r\n\r\nhttps://github.com/kkos/oniguruma/issues/59\r\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-9229"
}