{
  "IssueID": 4342,
  "VulnerabilityID": "CVE-2015-4143",
  "Release": "3.0",
  "Package": "wpa_supplicant",
  "Repository": "main",
  "FixedVersion": "2.3-r1",
  "Subject": "[v3.0] wpa_supplicant: vulnerability was found in peer implementation (CVE-2015-4143, CVE-2015-4144, CVE-2015-4145, CVE-2015-4146)",
  "Description": "A vulnerability was found in EAP-pwd server and peer implementation used\r\nin hostapd and wpa_supplicant, respectively. The EAP-pwd/Commit and\r\nEAP-pwd/Confirm message payload is processed without verifying that the\r\nreceived frame is long enough to include all the fields. This results in\r\nbuffer read overflow of up to couple of hundred bytes.\r\n\r\nThe exact result of this buffer overflow depends on the platform and may\r\nbe either not noticeable (i.e., authentication fails due to invalid data\r\nwithout any additional side effects) or process termination due to the\r\nbuffer read overflow being detected and stopped. The latter case could\r\npotentially result in denial of service when EAP-pwd authentication is\r\nused.\r\n\r\nFurther research into this issue found that the fragment reassembly\r\nprocessing is also missing a check for the Total-Length field and this\r\ncould result in the payload length becoming negative. This itself would\r\nnot add more to the vulnerability due to the payload length not being\r\nverified anyway. However, it is possible that a related reassembly step\r\nwould result in hitting an internal security check on buffer use and\r\nresult in the processing being terminated.\r\n\r\nVulnerable versions/configurations\r\n\r\nhostapd v1.0-v2.4 with CONFIG_EAP_PWD=y in the build configuration\r\n(hostapd/.config) and EAP-pwd authentication server enabled in runtime\r\nconfiguration.\r\n\r\nwpa_supplicant v1.0-v2.4 with CONFIG_EAP_PWD=y in the build\r\nconfiguration (wpa_supplicant/.config) and EAP-pwd enabled in a network\r\nprofile at runtime.\r\n\r\nAcknowledgments\r\n\r\nThanks to Kostya Kortchinsky of Google Security Team for discovering and\r\nreporting this issue.\r\n\r\nPossible mitigation steps\r\n\r\n- Merge the following commits and rebuild hostapd/wpa_supplicant:\r\nCVE-2015-4143:\r\n EAP-pwd peer: Fix payload length validation for Commit and Confirm\r\n EAP-pwd server: Fix payload length validation for Commit and Confirm\r\nCVE-2015-4144 (length check) + CVE-2015-4145 (memory leak):\r\n EAP-pwd peer: Fix Total-Length parsing for fragment reassembly\r\n EAP-pwd server: Fix Total-Length parsing for fragment reassembly\r\nCVE-2015-4146:\r\n EAP-pwd peer: Fix asymmetric fragmentation behavior\r\nThese patches are available from http://w1.fi/security/2015-4/\r\n\r\n- Update to hostapd/wpa_supplicant v2.5 or newer, once available\r\n\r\n- Remove CONFIG_EAP_PWD=y from build configuration\r\n\r\n- Disable EAP-pwd in runtime configuration\r\n\r\nReference: http://w1.fi/security/2015-4/eap-pwd-missing-payload-length-validation.txt\r\nhttp://www.openwall.com/lists/oss-security/2015/05/31/6\r\n"
}