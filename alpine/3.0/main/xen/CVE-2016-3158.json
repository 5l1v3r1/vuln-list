{
  "IssueID": 5493,
  "VulnerabilityID": "CVE-2016-3158",
  "Release": "3.0",
  "Package": "xen",
  "Repository": "main",
  "FixedVersion": "4.3.4-r3",
  "Subject": "[3.0] xen: Security issues (CVE-2016-3157, CVE-2016-3158,  CVE-2016-3159, CVE-2016-3960, CVE-2016-3961)",
  "Description": "*CVE-2016-3157, XSA-171*: I/O port access privilege escalation in x86-64 Linux \r\n\r\nIRET and POPF do not modify EFLAGS.IOPL when executed by code at a\r\nprivilege level other than zero.  Since PV Xen guests run at privilege\r\nlevel 3 (for 64-bit ones; 32-bit ones run at privilege level 1), to\r\ncompensate for this the context switching of EFLAGS.IOPL requires the\r\nguest to make use of a dedicated hypercall (PHYSDEVOP_set_iopl).  The\r\ninvocation of this hypercall, while present in the 32-bit context\r\nswitch path, is missing from its 64-bit counterpart.\r\n\r\nh3. References:\r\n\r\nhttp://xenbits.xen.org/xsa/advisory-171.html\r\n\r\n*CVE-2016-3158,  CVE-2016-3159,  XSA-172*: broken AMD FPU FIP/FDP/FOP leak workaround\r\n\r\nThere is a workaround in Xen to deal with the fact that AMD CPUs don't\r\nload the x86 registers FIP (and possibly FCS), FDP (and possibly FDS),\r\nand FOP from memory (via XRSTOR or FXRSTOR) when there is no pending\r\nunmasked exception.  (See XSA-52.)\r\n\r\nHowever, this workaround does not cover all possible input cases.\r\nThis is because writes to the hardware FSW.ES bit, which the current\r\nworkaround is based on, are ignored; instead, the CPU calculates\r\nFSW.ES from the pending exception and exception mask bits.  Xen\r\ntherefore needs to do the same.\r\n\r\nh3. References:\r\n\r\nhttp://xenbits.xen.org/xsa/advisory-172.html\r\n\r\n*CVE-2016-3960, XSA-173*: x86 shadow pagetables: address width overflow\r\n\r\nIn the x86 shadow pagetable code, the guest frame number of a\r\nsuperpage mapping is stored in a 32-bit field.  If a shadowed guest\r\ncan cause a superpage mapping of a guest-physical address at or above\r\n2^44 to be shadowed, the top bits of the address will be lost, causing\r\nan assertion failure or NULL dereference later on, in code that\r\nremoves the shadow.\r\n\r\nh3. References:\r\n\r\nhttp://xenbits.xen.org/xsa/advisory-173.html\r\n\r\n*CVE-2016-3961*:  hugetlbfs use may crash PV Linux guests\r\n\r\nHuge (2Mb) pages are generally unavailable to PV guests.  Since x86\r\nLinux pvops-based kernels are generally multi purpose, they would\r\nnormally be built with hugetlbfs support enabled.  Use of that\r\nfunctionality by an application in a PV guest would cause an\r\ninfinite page fault loop, and an OOPS to occur upon an attempt to\r\nterminate the hung application.\r\n\r\nh3. References:\r\n\r\nhttp://xenbits.xen.org/xsa/advisory-174.html\r\n\r\n\r\n\r\n\r\n\r\n"
}