{
  "IssueID": 4912,
  "VulnerabilityID": "CVE-2015-5309",
  "Release": "3.0",
  "Package": "putty",
  "Repository": "main",
  "FixedVersion": "0.66-r0",
  "Subject": "[3.0] putty: Integer overflow and buffer underrun in terminal emulator's ECH handling (CVE-2015-5309)",
  "Description": "A potentially memory-corrupting integer overflow in the handling of ECH (erase characters) control sequence in the terminal \r\nemulator was found in putty *versions between 0.54 and 0.65.* To exploit a vulnerability in the terminal emulator, an attacker\r\nmust be able to insert a carefully crafted escape sequence into the terminal stream. For a PuTTY SSH session, \r\nthis must be before encryption, so the attacker likely needs access to the server the victim is connecting to. For instance,\r\nan attacker on a multi-user machine that you connect to could trick victim into running cat on a file they control containing a malicious escape sequence.\r\n\r\nThe vulnerability arises because PuTTY uses signed integer variables to hold the number of characters to be erased and doesn't\r\nadequately check for overflow. This means that by passing a very large parameter to ECH, an attacker could cause check_boundary\r\nto inspect memory outside the terminal buffer. Were it to find UCSWIDE there, it would corrupt some nearby memory. This might be \r\nexploitable if the attacker could arrange for UCSWIDE to be in memory somewhere near a sensitive data structure. \r\n\r\nh3. Fixed In Version: \t\r\n\r\nputty 0.66\r\n\r\nh3. References:\r\n\r\nhttp://www.chiark.greenend.org.uk/~sgtatham/putty/wishlist/vuln-ech-overflow.html\r\nhttps://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-5309\r\n\r\nh3. Patch:\r\n\r\nhttp://tartarus.org/~simon-git/gitweb/?p=putty.git;a=commitdiff;h=6056396f77cafc7e40da4d09f1d6212408dcb065"
}