{
  "IssueID": 10620,
  "VulnerabilityID": "CVE-2019-10161",
  "Release": "3.7",
  "Package": "libvirt",
  "Repository": "main",
  "FixedVersion": "5.5.0-r0",
  "Subject": "[3.7] libvirt: Multiple vulnerabilities (CVE-2019-10161, CVE-2019-10166, CVE-2019-10167,  CVE-2019-10168)",
  "Description": "h2. CVE-2019-10161: arbitrary file read/exec via virDomainSaveImageGetXMLDesc API\r\n\r\nIt was discovered that libvirtd would permit readonly clients to use the\r\nvirDomainSaveImageGetXMLDesc() API, specifying an arbitrary path which \r\nwould be accessed with the permissions of the libvirtd process.  An\r\nattacker with access to the libvirtd socket could use this to probe the \r\nexistence of arbitrary files, cause denial of service or cause libvirtd \r\nto execute arbitrary programs.\r\n\r\nThis vulnerability was first present in libvirt v0.9.4.\r\n\r\nh3. Fixed In Version:\r\n\r\nlibvirt 4.10.1, libvirt 5.4.1\r\n\r\nh3. References:\r\n\r\nhttps://security-tracker.debian.org/tracker/CVE-2019-10161\r\nhttps://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10161\r\n\r\n\r\nh3. Patch:\r\n\r\nhttps://libvirt.org/git/?p=libvirt.git;a=commit;h=aed6a032cead4386472afb24b16196579e239580\r\n\r\n\r\n\r\nh2. CVE-2019-10166: virDomainManagedSaveDefineXML API exposed to readonly clients\r\n\r\nIt was discovered that libvirtd would permit readonly clients to use the\r\nvirDomainManagedSaveDefineXML() API, which would permit them to modify \r\nmanaged save state files.  If a managed save had already been created by \r\na privileged user, a local attacker could modify this file such that \r\nlibvirtd would execute an arbitrary program when the domain was resumed.\r\n\r\nThis vulnerability was first present in libvirt v3.6.1.\r\n\r\nh3. Fixed In Version:\r\n\r\nlibvirt 4.10.1, libvirt 5.4.1\r\n\r\nh3. References:\r\n\r\nhttps://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10166\r\nhttps://security-tracker.debian.org/tracker/CVE-2019-10166\r\n\r\n\r\nh3. Patch:\r\n\r\nhttps://libvirt.org/git/?p=libvirt.git;a=commit;h=db0b78457f183e4c7ac45bc94de86044a1e2056a\r\n\r\n\r\n\r\n\r\nh2. CVE-2019-10167: arbitrary command execution via virConnectGetDomainCapabilities API\r\n\r\nThe virConnectGetDomainCapabilities() libvirt API accepts an \"emulatorbin\" \r\nargument to specify the program providing emulation for a domain.  Since \r\nv1.2.19, libvirt will execute that program to probe the domain's \r\ncapabilities.  Read-only clients could specify an arbitrary path for this \r\nargument, causing libvirtd to execute a crafted executable with its own \r\n\r\nh3. Fixed In Version:\r\n\r\nlibvirt 4.10.1, libvirt 5.4.1\r\n\r\nh3. References:\r\n\r\nhttps://security-tracker.debian.org/tracker/CVE-2019-10167\r\n\r\n\r\nh3. Patch:\r\n\r\nhttps://libvirt.org/git/?p=libvirt.git;a=commit;h=8afa68bac0cf99d1f8aaa6566685c43c22622f26\r\n\r\nh2. CVE-2019-10168: arbitrary command execution via virConnectBaselineHypervisorCPU and virConnectCompareHypervisorCPU APIs\r\n\r\nThe virConnectBaselineHypervisorCPU() and virConnectCompareHypervisorCPU()\r\nlibvirt APIs accept an \"emulator\" argument to specify the program providing\r\nemulation for a domain.  Since v1.2.19, libvirt will execute that program to\r\nprobe the domain's capabilities.  Read-only clients could specify an arbitrary\r\npath for this argument, causing libvirtd to execute a crafted executable with\r\nits own privileges.\r\n\r\nh3. Fixed In Version:\r\n\r\nlibvirt 4.10.1, libvirt 5.4.1\r\n\r\n\r\nh3. References:\r\n\r\nhttps://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10168\r\nhttps://security-tracker.debian.org/tracker/CVE-2019-10168\r\n\r\nh3. Patch:\r\n\r\nhttps://libvirt.org/git/?p=libvirt.git;a=commit;h=bf6c2830b6c338b1f5699b095df36f374777b291\r\n\r\n\r\n\r\n"
}