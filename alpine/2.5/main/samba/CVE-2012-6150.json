{
  "IssueID": 2483,
  "VulnerabilityID": "CVE-2012-6150",
  "Release": "2.5",
  "Package": "samba",
  "Repository": "main",
  "FixedVersion": "3.6.22-r0",
  "Subject": "[v2.5] Samba 4.1.3, 4.0.13 and 3.6.22 Security Releases (CVE-2013-4408, CVE-2012-6150)",
  "Description": "\u003cpre\u003e\r\nCVE-2013-4408 (DCE-RPC fragment length field is incorrectly checked) and\r\nCVE-2012-6150 (pam_winbind login without require_membership_of restrictions).\r\n\r\no  CVE-2013-4408:\r\n   Samba versions 3.4.0 and above (versions 3.4.0 - 3.4.17, 3.5.0 -\r\n   3.5.22, 3.6.0 - 3.6.21, 4.0.0 - 4.0.12 and including 4.1.2) are\r\n   vulnerable to buffer overrun exploits in the client processing of\r\n   DCE-RPC packets. This is due to incorrect checking of the DCE-RPC\r\n   fragment length in the client code.\r\n\r\n   This is a critical vulnerability as the DCE-RPC client code is part of\r\n   the winbindd authentication and identity mapping daemon, which is\r\n   commonly configured as part of many server installations (when joined\r\n   to an Active Directory Domain). A malicious Active Directory Domain\r\n   Controller or man-in-the-middle attacker impersonating an Active\r\n   Directory Domain Controller could achieve root-level access by\r\n   compromising the winbindd process.\r\n\r\n   Samba server versions 3.4.0 - 3.4.17 and versions 3.5.0 - 3.5.22 are\r\n   also vulnerable to a denial of service attack (server crash) due to a\r\n   similar error in the server code of those versions.\r\n\r\n   Samba server versions 3.6.0 and above (including all 3.6.x versions,\r\n   all 4.0.x versions and 4.1.x) are not vulnerable to this problem.\r\n\r\n   In addition range checks were missing on arguments returned from calls\r\n   to the DCE-RPC functions LookupSids (lsa and samr), LookupNames (lsa and samr)\r\n   and LookupRids (samr) which could also cause similar problems.\r\n\r\n   As this was found during an internal audit of the Samba code there are\r\n   no currently known exploits for this problem (as of December 9th 2013).\r\n\r\no  CVE-2012-6150:\r\n   Winbind allows for the further restriction of authenticated PAM logins using\r\n   the require_membership_of parameter. System administrators may specify a list\r\n   of SIDs or groups for which an authenticated user must be a member of. If an\r\n   authenticated user does not belong to any of the entries, then login should\r\n   fail. Invalid group name entries are ignored.\r\n\r\n   Samba versions 3.3.10, 3.4.3, 3.5.0 and later incorrectly allow login from\r\n   authenticated users if the require_membership_of parameter specifies only\r\n   invalid group names.\r\n\r\n   This is a vulnerability with low impact. All require_membership_of group\r\n   names must be invalid for this bug to be encountered.\r\n\u003c/pre\u003e\r\n\r\nhttp://www.samba.org/samba/security/CVE-2013-4408\r\nhttp://www.samba.org/samba/security/CVE-2012-6150"
}