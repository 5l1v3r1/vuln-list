{
  "IssueID": 2886,
  "VulnerabilityID": "CVE-2014-0210",
  "Release": "2.5",
  "Package": "libxfont",
  "Repository": "main",
  "FixedVersion": "1.4.7-r1",
  "Subject": "[v2.5] libxfont: X Font Service Protocol \u0026 Font metadata file handling issues (CVE-2014-0209,CVE-2014-0210,CVE-2014-0211)",
  "Description": "\r\nPatches are found: http://cgit.freedesktop.org/xorg/lib/libXfont/log/?h=libXfont-1.4-branch\r\n\r\n\r\nhttp://lists.x.org/archives/xorg-announce/2014-May/002431.html\r\n\u003cpre\u003e\r\nX.Org Security Advisory:  May 13, 2014\r\nX Font Service Protocol \u0026 Font metadata file handling issues in libXfont\r\n========================================================================\r\n\r\nDescription:\r\n============\r\n\r\nIlja van Sprundel, a security researcher with IOActive, has discovered\r\nseveral issues in the way the libXfont library handles the responses \r\nit receives from xfs servers, and has worked with X.Org's security team \r\nto analyze, confirm, and fix these issues.\r\n\r\nMost of these issues stem from libXfont trusting the font server to send\r\nvalid protocol data, and not verifying that the values will not overflow \r\nor cause other damage.   This code is commonly called from the X server \r\nwhen an X Font Server is active in the font path, so may be running in a \r\nsetuid-root process depending on the X server in use.  Exploits of this\r\npath could be used by a local, authenticated user to attempt to raise\r\nprivileges; or by a remote attacker who can control the font server to\r\nattempt to execute code with the privileges of the X server.  (CVE-2014-XXXA\r\nis the exception, as it does not involve communication with a font server,\r\nas explained below.)\r\n\r\nThe vulnerabilities are:\r\n\r\n- CVE-2014-0209: integer overflow of allocations in font metadata file parsing\r\n\r\n    When a local user who is already authenticated to the X server adds\r\n    a new directory to the font path, the X server calls libXfont to open\r\n    the fonts.dir and fonts.alias files in that directory and add entries\r\n    to the font tables for every line in it.  A large file (~2-4 gb) could\r\n    cause the allocations to overflow, and allow the remaining data read \r\n    from the file to overwrite other memory in the heap.\r\n\r\n    Affected functions: FontFileAddEntry(), lexAlias()\r\n\r\n- CVE-2014-0210: unvalidated length fields when parsing xfs protocol replies\r\n\r\n    When parsing replies received from the font server, these calls do not\r\n    check that the lengths and/or indexes returned by the font server are\r\n    within the size of the reply or the bounds of the memory allocated to\r\n    store the data, so could write past the bounds of allocated memory when\r\n    storing the returned data.\r\n\r\n    Affected functions: _fs_recv_conn_setup(), fs_read_open_font(),\r\n    fs_read_query_info(), fs_read_extent_info(), fs_read_glyphs(),\r\n    fs_read_list(), fs_read_list_info()\r\n\r\n- CVE-2014-0211: integer overflows calculating memory needs for xfs replies\r\n\r\n    These calls do not check that their calculations for how much memory\r\n    is needed to handle the returned data have not overflowed, so can\r\n    result in allocating too little memory and then writing the returned\r\n    data past the end of the allocated buffer.\r\n\r\n    Affected functions: fs_get_reply(), fs_alloc_glyphs(),\r\n    fs_read_extent_info()\r\n\r\n\r\nAffected Versions\r\n=================\r\n\r\nX.Org believes all prior versions of this library contain these flaws,\r\ndating back to its introduction in X11R5.\r\n\r\n\r\nFixes\r\n=====\r\n\r\nFixes are available in the patches for these libXfont git commits:\r\n\t2f5e57317339c526e6eaee1010b0e2ab8089c42e\r\n\t05c8020a49416dd8b7510cbba45ce4f3fc81a7dc\r\n\t891e084b26837162b12f841060086a105edde86d\r\n\tcbb64aef35960b2882be721f4b8fbaa0fb649d12\r\n\t0f1a5d372c143f91a602bdf10c917d7eabaee09b\r\n\t491291cabf78efdeec8f18b09e14726a9030cc8f\r\n\tc578408c1fd4db09e4e3173f8a9e65c81cc187c1\r\n\ta42f707f8a62973f5e8bbcd08afb10a79e9cee33\r\n\ta3f21421537620fc4e1f844a594a4bcd9f7e2bd8\r\n\t520683652564c2a4e42328ae23eef9bb63271565\r\n\t5fa73ac18474be3032ee7af9c6e29deab163ea39\r\n\td338f81df1e188eb16e1d6aeea7f4800f89c1218\r\n\r\nWhich are available now from:\r\n      git://anongit.freedesktop.org/git/xorg/lib/libXfont\r\n      http://cgit.freedesktop.org/xorg/lib/libXfont/\r\n\r\nFixes will also be included in these module releases from X.Org:\r\n      libXfont 1.4.8\r\n      libXfont 1.4.99.901 (1.5.0 RC 1)\r\n\r\nThanks\r\n======\r\n\r\nX.Org thanks Ilja van Sprundel of IOActive for reporting these issues to our\r\nsecurity team and assisting them in understanding them and evaluating our\r\nfixes, and Alan Coopersmith of Oracle for coordinating the X.Org response and\r\ndeveloping the fixes for these issues.\r\n\u003c/pre\u003e"
}