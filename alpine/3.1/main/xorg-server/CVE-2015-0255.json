{
  "IssueID": 4001,
  "VulnerabilityID": "CVE-2015-0255",
  "Release": "3.1",
  "Package": "xorg-server",
  "Repository": "main",
  "FixedVersion": "1.16.4-r0",
  "Subject": "[v3.1] xorg-server: leak in the XkbSetGeometry request (CVE-2015-0255)",
  "Description": "Olivier Fourdan from Red Hat has discovered a protocol handling issue in the way the X server code base handles the XkbSetGeometry request.\r\n\r\nThe issue stems from the server trusting the client to send valid string lengths in the request data. A malicious client with string lengths exceeding the request length can cause the server to copy adjacent memory data into the XKB structs. This data is then available to the client via the XkbGetGeometry request. The data length is at least up to 64k, it is possible to obtain more data by chaining strings, each string length is then determined by whatever happens to be in that 16-bit region of memory.\r\n\r\nA similarly crafted request can likely cause the X server to crash.\r\n\r\nAffected Versions\r\n------------------\r\nThis bug appears to have been introduced in X11R6.6 (March 1996) and is thus believed to be present in every X server release since, including the current stable release 1.16.3 and 1.17.0.\r\n\r\nFixes\r\n------\r\nA fix is available via the patch linked below which is intended to be included in xorg-server-1.16.4 and 1.17.1\r\n\r\nhttp://cgit.freedesktop.org/xorg/xserver/commit/?id=20079c36cf7d377938ca5478447d8b9045cb7d43\r\n\r\nNote that this patch requires another patch to apply without conflicts:\r\n\r\nhttp://cgit.freedesktop.org/xorg/xserver/commit/?id=81c90dc8f0aae3b65730409b1b615b5fa7280ebd\r\n\r\nReferences\r\n-----------\r\nhttp://seclists.org/oss-sec/2015/q1/506\r\nhttp://www.x.org/wiki/Development/Security/Advisory-2015-02-10/\r\n\r\nNote: there is a non-consistence in posted on the above links and CVD Mitre database concerning vulnerable versions:\r\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0255\r\n"
}