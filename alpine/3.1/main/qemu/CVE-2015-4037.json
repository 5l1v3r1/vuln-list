{
  "IssueID": 4327,
  "VulnerabilityID": "CVE-2015-4037",
  "Release": "3.1",
  "Package": "qemu",
  "Repository": "main",
  "FixedVersion": "2.1.3-r1",
  "Subject": "[v3.1] qemu: tmp vulns (CVE-2015-4037)",
  "Description": "So some suspicious looking tmp usage in qemu ...\r\n\r\nsnprintf(s-\u003esmb_dir, sizeof(s-\u003esmb_dir), \"/tmp/qemu-smb.%ld-%d\",\r\n (long)getpid(), instance++);\r\n if (mkdir(s-\u003esmb_dir, 0700) \u003c 0) {\r\n error_report(\"could not create samba server dir '%s'\", s-\u003esmb_dir);\r\n return -1;\r\n\r\nThe simplest attack would be a DoS in which someone creates /tmp/qemu-smb.*-* files to prevent the legitimate creation of\r\ns-\u003esmb_dir (mkdir will not follow a symlink).\r\n\r\nReference: http://www.openwall.com/lists/oss-security/2015/05/23/4\r\n"
}