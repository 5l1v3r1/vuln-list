{
  "IssueID": 6585,
  "VulnerabilityID": "CVE-2016-10011",
  "Release": "3.3",
  "Package": "openssh",
  "Repository": "main",
  "FixedVersion": "7.2_p2-r3",
  "Subject": "[3.3] openssh: multiple issues (CVE-2016-10009, CVE-2016-10010, CVE-2016-10011, CVE-2016-10012)",
  "Description": "h2. CVE-2016-10009: loading of untrusted PKCS#11 modules in ssh-agent\r\n\r\nSsh-agent could load PKCS#11 modules from paths outside of a trusted whitelist. An attacker able to load a crafted PKCS#11 module across a forwarded agent channel could potentially \r\nuse this flaw to execute arbitrary code on the system running the ssh-agent. Note that the attacker must have control of the forwarded agent-socket and the ability to write to the filesystem of the host running ssh-agent.\r\n\r\nThis issue was fixed by only allowing the loading of module from a trusted (and configurable) whitelist.\r\n\r\nh3. Fixed In Version:\t\r\n\r\nopenssh 7.4\r\n\r\n\r\nh3. References:\r\n\r\nhttps://www.openssh.com/txt/release-7.4\r\nhttp://seclists.org/oss-sec/2016/q4/708\r\n\r\nUpstream patch:\r\n\r\nhttp://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/ssh-agent.c.diff?r1=1.214\u0026r2=1.215\u0026sortby=date\u0026f=h\r\n\r\n\r\n\r\nh2. CVE-2016-10010: privilege escalation via Unix domain socket forwarding\r\n\r\nWhen privilege separation was disabled in OpenSSH, forwarded Unix-domain sockets would be created by sshd with root privileges instead of the privileges of the authenticated user. \r\nThis could allow an authenticated attacker to potentially gain root privileges on the host system.\r\n\r\nh3. Fixed In Version:\t\r\n\r\nopenssh 7.4\r\n\r\nh3. References:\r\n\r\nhttps://www.openssh.com/txt/release-7.4\r\nhttp://seclists.org/oss-sec/2016/q4/708\r\n\r\nh3. Upstream patch:\r\n\r\nhttp://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/serverloop.c.diff?r1=1.188\u0026r2=1.189\u0026sortby=date\u0026f=h\r\n\r\nh2. CVE-2016-10011: Leak of host private key material to privilege-separated child process via realloc()\r\n\r\nA theoretical leak of host private key material to privilege-separated child processes via realloc() when reading keys. \r\nNo such leak was observed in practice for normal-sized keys, nor does a leak to the child processes directly expose key material to unprivileged users.\r\n\r\nh3. Fixed In Version:\t\r\n\r\nopenssh 7.4\r\n\r\n\r\nh3. References:\r\n\r\nhttps://www.openssh.com/txt/release-7.4\r\nhttp://seclists.org/oss-sec/2016/q4/708\r\n\r\nh3. Upstream patch:\r\n\r\nhttp://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/authfile.c.diff?r1=1.121\u0026r2=1.122\r\n\r\nh2. CVE-2016-10012: Bounds check can be evaded in the shared memory manager used by pre-authentication compression support\r\n\r\nThe shared memory manager used by pre-authentication compression support had a bounds checks that could be elided by some optimising compilers. \r\nAdditionally, this memory manager was incorrectly accessible when pre-authentication compression was disabled. \r\nThis could potentially allow attacks against the privileged monitor process from the sandboxed privilege-separation process (a compromise of the latter would be required first).\r\n\r\nh3. Fixed In Version:\t\r\n\r\nopenssh 7.4\r\n\r\n\r\nh3. References:\r\n\r\nhttps://www.openssh.com/txt/release-7.4\r\nhttp://seclists.org/oss-sec/2016/q4/708\r\n\r\n\r\nh3. Upstream patches:\r\n\r\nhttp://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/monitor.c.diff?r1=1.165\u0026r2=1.166\r\nhttp://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/monitor.h.diff?r1=1.19\u0026r2=1.20\r\n"
}