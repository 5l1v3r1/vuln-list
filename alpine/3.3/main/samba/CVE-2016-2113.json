{
  "IssueID": 5496,
  "VulnerabilityID": "CVE-2016-2113",
  "Release": "3.3",
  "Package": "samba",
  "Repository": "main",
  "FixedVersion": "4.2.11-r0",
  "Subject": "[3.3] samba: Multiple security issues (CVE-2015-5370, CVE-2016-2110, CVE-2016-2111, CVE-2016-2112, CVE-2016-2113, CVE-2016-2114, CVE-2016-2115, CVE-2016-2118)",
  "Description": "h2. CVE-2015-5370:  Multiple errors in DCE-RPC code.\r\n\r\nSamba 3.x and 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not properly implement the DCE-RPC layer, \r\nwhich allows remote attackers to perform protocol-downgrade attacks, cause a denial of service (application crash or CPU consumption),\r\nor possibly execute arbitrary code on a client system via unspecified vectors.\r\n\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2015-5370.html\r\nhttps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-5370\r\n\r\n\r\nh2. CVE-2016-2110: Man in the middle attacks possible with NTLMSSP\r\n\r\nThe NTLMSSP authentication implementation in Samba 3.x and 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 allows man-in-the-middle\r\nattackers to perform protocol-downgrade attacks by modifying the client-server data stream to remove application-layer flags or encryption settings, \r\nas demonstrated by clearing the NTLMSSP_NEGOTIATE_SEAL or NTLMSSP_NEGOTIATE_SIGN option to disrupt LDAP security.\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2016-2110.html\r\nhttps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-2110\r\n\r\nh2. CVE-2016-2111: NETLOGON Spoofing Vulnerability.\r\n\r\nThe NETLOGON service in Samba 3.x and 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2, when a domain controller is configured, \r\nallows remote attackers to spoof the computer name of a secure channel's endpoint, and obtain sensitive session information, by running a crafted\r\napplication and leveraging the ability to sniff network traffic, a related issue to CVE-2015-0005.\r\n\r\nh3. References:\r\n\r\nhttps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-2111\r\nhttps://www.samba.org/samba/security/CVE-2016-2111.html\r\n\r\nh2. CVE-2016-2112: The LDAP client and server don't enforce integrity protection\r\n\r\nThe bundled LDAP client library in Samba 3.x and 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not recognize \r\nthe \"client ldap sasl wrapping\" setting, which allows man-in-the-middle attackers to perform LDAP protocol-downgrade attacks by modifying the client-server data stream.\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2016-2112.html\r\nhttps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-2112\r\n\r\nh2. CVE-2016-2113:  Missing TLS certificate validation allows man in the middle attacks\r\n\r\n\r\n\r\nSamba 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not verify X.509 certificates from TLS servers, \r\nwhich allows man-in-the-middle attackers to spoof LDAPS and HTTPS servers and obtain sensitive information via a crafted certificate.\r\n\r\n\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2016-2113.html\r\nhttps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-2113\r\n\r\nh2. CVE-2016-2114: \"server signing = mandatory\" not enforced\r\n\r\nThe SMB1 protocol implementation in Samba 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not recognize \r\nthe \"server signing = mandatory\" setting, which allows man-in-the-middle attackers to spoof SMB servers by modifying the client-server data stream.\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2016-2114.html\r\nhttps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-2114\r\n\r\nh2. CVE-2016-2115: SMB client connections for IPC traffic are not integrity protected\r\n\r\nSamba 3.x and 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 does not require SMB signing within a DCERPC\r\nsession over ncacn_np, which allows man-in-the-middle attackers to spoof SMB clients by modifying the client-server data stream.\r\n\r\nh3. References:\r\n\r\nhttps://www.samba.org/samba/security/CVE-2016-2115.html\r\nhttps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-2115\r\n\r\nh2. CVE-2016-2118: SAMR and LSA man in the middle attacks possible \r\n\r\nThe MS-SAMR and MS-LSAD protocol implementations in Samba 3.x and 4.x before 4.2.11, 4.3.x before 4.3.8, and 4.4.x before 4.4.2 mishandle DCERPC connections,\r\nwhich allows man-in-the-middle attackers to perform protocol-downgrade attacks and impersonate users by modifying the client-server data stream, aka \"BADLOCK.\"\r\n\r\nh3. References: \r\n\r\nhttps://www.samba.org/samba/security/CVE-2016-2118.html\r\nhttps://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-2118\r\n\r\n\r\n"
}