{
  "IssueID": 4469,
  "VulnerabilityID": "CVE-2015-3228",
  "Release": "2.7",
  "Package": "ghostscript",
  "Repository": "main",
  "FixedVersion": "9.10-r1",
  "Subject": "[v2.7] ghostscript: Crash file for the ps2pdf command (CVE-2015-3228)",
  "Description": "The crash can be triggered with the following command on older versions of Ghostscript:\r\n\r\n$ ps2pdf test.ps\r\nSegmentation fault\r\n\r\nThe affected versions are still shipped by various distributions.\r\n\r\nps2pdf is a shell script that calls the gs binary in the following way:\r\n\r\n$ /usr/bin/gs P dSAFER -dCompatibilityLevel=1.4 -q -P dNOPAUSE -dBATCH -sDEVICE=pdfwrite -sstdout=%stderr -sOutputFile=test.pdf -P -dSAFER -dCompatibilityLevel=1.4 -c .setpdfwrite -f test.ps\r\nSegmentation fault\r\n\r\nI attached gdb and valgrind sessions showing the crash on RHEL 6.6 and RHEL 7.1.1503.\r\n\r\nThe versions of the affected packages on RHEL are:\r\nRHEL6.6\r\nghostscript-8.70-19.el6.x86_64\r\nghostscript-debuginfo-8.70-19.el6.x86_64\r\nghostscript-fonts-5.50-23.2.el6.noarch\r\n\r\nRHEL7.1.1503\r\nghostscript-9.07-18.el7.x86_64\r\nghostscript-debuginfo-9.07-18.el7.x86_64\r\nghostscript-fonts-5.50-32.el7.noarch\r\n\r\nThe problem does not occur with current source revision.\r\n\r\nThe following commit fixes the segfault, but the problem is not mentioned in\r\nthe commit log:\r\necc7a199e9307475c37fea0c44d24b85df814ead\r\n\r\nThe offending file seems to be gs/Resource/Init/gs_ttf.ps\r\n\r\nIf one replaces this file with the one from the specified commit (or from\r\nthe current master) on RHEL 7.1.1503 or RHEL 6.6, the segfault does not\r\noccur anymore.\r\n\r\nSince the influence of this commit on the problem is not yet fully understood,\r\nthe problem might still be present in current version of gs.\r\n\r\nReference:\r\nhttp://bugs.ghostscript.com/show_bug.cgi?id=696041\r\n"
}