{
  "IssueID": 2560,
  "VulnerabilityID": "CVE-2013-6424",
  "Release": "2.7",
  "Package": "xorg-server",
  "Repository": "main",
  "FixedVersion": "1.14.4-r1",
  "Subject": "[v2.7] xorg-server: integer underflow (CVE-2013-6424)",
  "Description": "Package        : xorg-server\r\nVulnerability  : integer underflow\r\nProblem type   : remote\r\nDebian-specific: no\r\nCVE ID         : CVE-2013-6424\r\n\r\nAn integer underflow flaw was found in the X.Org server when handling trapezoids. A malicious, authorized client could use this flaw to crash the X.Org server.\r\n\r\nReferences:\r\nhttp://seclists.org/oss-sec/2013/q4/399\r\nhttp://patchwork.freedesktop.org/patch/14769/\r\n\r\n\r\n*Patch*\r\n\r\ndiff --git a/exa/exa_render.c b/exa/exa_render.c\r\nindex 172e2b5..807eeba 100644\r\n--- a/exa/exa_render.c\r\n+++ b/exa/exa_render.c\r\n@@ -1141,7 +1141,8 @@  exaTrapezoids(CARD8 op, PicturePtr pSrc, PicturePtr pDst,\r\n \r\n         exaPrepareAccess(pPicture-\u003epDrawable, EXA_PREPARE_DEST);\r\n         for (; ntrap; ntrap--, traps++)\r\n-            (*ps-\u003eRasterizeTrapezoid) (pPicture, traps, -bounds.x1, -bounds.y1);\r\n+            if (xTrapezoidValid(traps))\r\n+                (*ps-\u003eRasterizeTrapezoid) (pPicture, traps, -bounds.x1, -bounds.y1);\r\n         exaFinishAccess(pPicture-\u003epDrawable, EXA_PREPARE_DEST);\r\n \r\n         xRel = bounds.x1 + xSrc - xDst;\r\ndiff --git a/render/picture.h b/render/picture.h\r\nindex c85353a..fcd6401 100644\r\n--- a/render/picture.h\r\n+++ b/render/picture.h\r\n@@ -211,7 +211,7 @@  typedef pixman_fixed_t xFixed;\r\n /* whether 't' is a well defined not obviously empty trapezoid */\r\n #define xTrapezoidValid(t)  ((t)-\u003eleft.p1.y != (t)-\u003eleft.p2.y \u0026\u0026 \\\r\n \t\t\t     (t)-\u003eright.p1.y != (t)-\u003eright.p2.y \u0026\u0026 \\\r\n-\t\t\t     (int) ((t)-\u003ebottom - (t)-\u003etop) \u003e 0)\r\n+\t\t\t     ((t)-\u003ebottom \u003e (t)-\u003etop))\r\n \r\n /*\r\n  * Standard NTSC luminance conversions:\r\n\r\n"
}