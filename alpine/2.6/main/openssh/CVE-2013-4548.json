{
  "IssueID": 2347,
  "VulnerabilityID": "CVE-2013-4548",
  "Release": "2.6",
  "Package": "openssh",
  "Repository": "main",
  "FixedVersion": "6.2_p2-r1",
  "Subject": "[v2.6] OpenSSH Security Advisory: gcmrekey.adv (CVE-2013-4548)",
  "Description": "OpenSSH Security Advisory: gcmrekey.adv\r\n\r\nThis document may be found at: http://www.openssh.com/txt/gcmrekey.adv\r\n\r\n\u003cpre\u003e\r\n1. Vulnerability\r\n\r\n        A memory corruption vulnerability exists in the post-\r\n        authentication sshd process when an AES-GCM cipher\r\n        (aes128-gcm@openssh.com or aes256-gcm@openssh.com) is\r\n        selected during kex exchange.\r\n\r\n        If exploited, this vulnerability might permit code execution\r\n        with the privileges of the authenticated user and may\r\n        therefore allow bypassing restricted shell/command\r\n        configurations.\r\n\r\n2. Affected configurations\r\n\r\n        OpenSSH 6.2 and OpenSSH 6.3 when built against an OpenSSL\r\n        that supports AES-GCM.\r\n\r\n3. Mitigation\r\n\r\n        Disable AES-GCM in the server configuration. The following\r\n        sshd_config option will disable AES-GCM while leaving other\r\n        ciphers active:\r\n\r\n        Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc\r\n\r\n4. Details\r\n\r\n        When using AES-GCM, sshd was not initialising a Message\r\n        Authentication Code (MAC) context that is unused when the\r\n        cipher mode offers authentication itself. This context\r\n        contains some callback pointers, including a cleanup callback\r\n        that was still being invoked during a rekeying operation.\r\n        As such, the address being called was derived from previous\r\n        heap contents.\r\n\r\n\tThis vulnerability is mitigated by the difficulty of\r\n        pre-loading the heap with a useful callback address and by\r\n        any platform address-space layout randomisation applied to\r\n        sshd and the shared libraries it depends upon.\r\n\r\n5. Credit\r\n\r\n        This issue was identified by Markus Friedl (an OpenSSH\r\n\tdeveloper) on November 7th, 2013.\r\n\r\n6. Fix\r\n\r\n        OpenSSH 6.4 contains a fix for this vulnerability. Users who\r\n        prefer to continue to use OpenSSH 6.2 or 6.3 may apply this\r\n        patch:\r\n\r\nIndex: monitor_wrap.c\r\n===================================================================\r\nRCS file: /cvs/src/usr.bin/ssh/monitor_wrap.c,v\r\nretrieving revision 1.76\r\ndiff -u -p -u -r1.76 monitor_wrap.c\r\n--- monitor_wrap.c\t17 May 2013 00:13:13 -0000\t1.76\r\n+++ monitor_wrap.c\t6 Nov 2013 16:31:26 -0000\r\n@@ -469,7 +469,7 @@ mm_newkeys_from_blob(u_char *blob, int b\r\n \tbuffer_init(\u0026b);\r\n \tbuffer_append(\u0026b, blob, blen);\r\n \r\n-\tnewkey = xmalloc(sizeof(*newkey));\r\n+\tnewkey = xcalloc(1, sizeof(*newkey));\r\n \tenc = \u0026newkey-\u003eenc;\r\n \tmac = \u0026newkey-\u003emac;\r\n \tcomp = \u0026newkey-\u003ecomp;\r\n\u003c/pre\u003e\r\n"
}